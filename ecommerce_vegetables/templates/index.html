{% extends 'base.html' %}
{% block content %}
<!-- Custom CSS -->
<link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">

<div class="container mt-5">

  <h2 class="mb-5 fw-bold text-center">
    ðŸ¥¬ Fresh Vegetables Delivered to Your Doorstep
  </h2>

  <div class="row g-4">
    {% for product in products %}
    <div class="col-lg-3 col-md-4 col-sm-6">
      <div class="card h-100 shadow-sm border-0 rounded-4 overflow-hidden position-relative hover-scale">

        <!-- Product Image -->
        <img src="{{ url_for('static', filename='images/' ~ product.image) }}"
             class="card-img-top"
             alt="{{ product.name }}"
             style="height:220px; object-fit:cover; transition: transform 0.3s;">

        <!-- Availability Badge -->
        {% if product.status == 'available' %}
        <span class="badge position-absolute top-2 start-2 bg-success text-white px-3 py-1 rounded-pill">
          Available
        </span>
        {% else %}
        <span class="badge position-absolute top-2 start-2 bg-warning text-dark px-3 py-1 rounded-pill">
          Upcoming
        </span>
        {% endif %}

        <!-- Card Body -->
        <div class="card-body d-flex flex-column">

          <!-- Product Name & Price -->
          <h5 class="fw-semibold mb-1">{{ product.name }}</h5>
          <p class="text-success fw-bold mb-3">
            {% if product.status == 'available' %}
              â‚¹{{ "%.2f"|format(product.price) }}
            {% else %}
              Coming Soon
            {% endif %}
          </p>

          {% if current_user.is_authenticated %}
            {% if product.status == 'available' %}
            <!-- ADD TO CART FORM -->
            <form action="{{ url_for('add_to_cart', id=product.id) }}" method="POST" class="mt-auto">

          

              <!-- Add to Cart Button -->
             <button type="submit"
        class="btn btn-primary w-100 btn-hover add-to-cart-btn"
        data-product-id="{{ product.id }}">
  ðŸ›’ Add to Cart
</button>

            </form>
            {% else %}
            <!-- Coming Soon Button -->
            <button class="btn btn-secondary w-100 mt-auto" disabled>Coming Soon</button>
            {% endif %}
          {% else %}
            <!-- Login Button -->
            <a href="{{ url_for('login') }}" class="btn btn-outline-primary w-100 mt-auto">Login to Buy</a>
          {% endif %}

        </div>
      </div>
    </div>
    {% else %}
    <div class="col-12 text-center py-5">
      <p class="text-muted fs-5">
        No products available at the moment. Check back soon! ðŸ¥¦
      </p>
      <a href="{{ url_for('index') }}" class="btn btn-primary mt-2">Shop Now</a>
    </div>
    {% endfor %}
  </div>
</div>



<script src="{{ url_for('static', filename='js/script.js') }}"></script>

{% endblock %}
